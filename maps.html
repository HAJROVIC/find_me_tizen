<!DOCTYPE html>

<html lang="en" class="no-js">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width" />
    <title></title>
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="Jan Šimeček - http://themeforest.net/user/xRicrdx">



    <!-- Web App Data -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <!-- =Web App Data -->


    <!-- Icons -->
    <!-- non-retina iPhone pre iOS 7 -->
    <link rel="apple-touch-icon-precomposed" href="webapp/icon57.png" sizes="57x57">
    <!-- non-retina iPad pre iOS 7 -->
    <link rel="apple-touch-icon-precomposed" href="webapp/icon72.png" sizes="72x72">
    <!-- non-retina iPad iOS 7 -->
    <link rel="apple-touch-icon-precomposed" href="webapp/icon76.png" sizes="76x76">
    <!-- retina iPhone pre iOS 7 -->
    <link rel="apple-touch-icon-precomposed" href="webapp/icon114.png" sizes="114x114">
    <!-- retina iPhone iOS 7 -->
    <link rel="apple-touch-icon-precomposed" href="webapp/icon120.png" sizes="120x120">
    <!-- retina iPad pre iOS 7 -->
    <link rel="apple-touch-icon-precomposed" href="webapp/icon144.png" sizes="144x144">
    <!-- retina iPad iOS 7 -->
    <link rel="apple-touch-icon-precomposed" href="webapp/icon152.png" sizes="152x152">



    <!-- iPhone SPLASHSCREEN-->
    <link href="webapp/apple-touch-startup-image-320x460.png" media="(device-width: 320px)" rel="apple-touch-startup-image">
    <!-- iPhone (Retina) SPLASHSCREEN-->
    <link href="webapp/apple-touch-startup-image-640x920.png" media="(device-width: 320px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
    <!-- iPhone SPLASHSCREEN 4" -->
    <link href="webapp/apple-touch-startup-image-640x1096.png" rel="apple-touch-startup-image" media="(device-height: 568px)">
    <!-- iPad (portrait) SPLASHSCREEN-->
    <link href="webapp/apple-touch-startup-image-768x1004.png" media="(device-width: 768px) and (orientation: portrait)" rel="apple-touch-startup-image">
    <!-- iPad (landscape) SPLASHSCREEN-->
    <link href="webapp/apple-touch-startup-image-1024x748.png" media="(device-width: 768px) and (orientation: landscape)" rel="apple-touch-startup-image">
    <!-- iPad (Retina, portrait) SPLASHSCREEN-->
    <link href="webapp/apple-touch-startup-image-1536x2008.png" media="(device-width: 1536px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">
    <!-- iPad (Retina, landscape) SPLASHSCREEN-->
    <link href="webapp/apple-touch-startup-image-2048x1496.png" media="(device-width: 1536px)  and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" media="(device-width: 1536px)  and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)"
    rel="apple-touch-startup-image">
    <!-- =Web App Data -->



    <!-- Favicon -->

    <link href="img/favicon.ico" rel="shortcut icon" type="image/x-icon">

    <!-- =Favicon -->



    <!-- Import Styles-->

    <link rel='stylesheet' href='css/vendor/normalize.css'>
    <link rel='stylesheet' href='css/vendor/fontello.css'>
    <link rel='stylesheet' href='css/style.css'>
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

    <!-- =Import Styles-->

    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="./js/main.js"></script>



    <!-- Import GoogleWebFonts -->

    <link href='http://fonts.googleapis.com/css?family=Raleway:400,300,100,200,700,500' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,300,600,700' rel='stylesheet' type='text/css'>


    <!-- =Import GoogleWebFonts -->



    <!-- Modernizr & HTML5 Shiv -->

    <script src='js/vendor/modernizr.js'></script>

    <!--[if lt IE 9]>
        <script src='js/vendor/html5shiv.js'></script>
        <![endif]-->

    <!-- =Modernizr & HTML5 Shiv -->



</head>

<body class="touch-gesture" onload="init()">




    <!-- Container -->

    <div id="container">



        <!-- Main Content-->

        <!-- Sidebar -->

        <aside id="sidemenu-container">
            <div id="sidemenu">
                <div id="author-profile">
                    <div class="author-profile-photo" id="image">
                    </div>
                    <div style="color:#ffffff" class="author-profile-content" id="details">
                    </div>
                </div>
                <nav id="nav-container">
                    <ul class="nav">
                        <li>
                            <a href="index.html"> <i style="color:#ffffff" class="icon-globe-1"></i> Home</a>
                        </li>
                        <li>
                            <a href="profile.html"> <i style="color:#ffffff" class="icon-user-1"></i> Profile</a>
                        </li>
                        <li>
                            <a href="#" class="nav-with-ul"> <i style="color:#ffffff" class="icon-flow-cascade"></i> My circles</a>
                            <span class="nav-child-container"><span class="nav-child-trigger">+</span></span>
                            <ul id="circles-list" style="height: 0;">
                            </ul>
                        </li>
                        <li>
                            <a href="locate.html" class='current'> <i style="color:#ffffff" class="icon-location-1"></i> Locate my friends</a>
                        </li>
                        <li>
                            <a href="" class="nav-with-ul" onClick="logout()"><i style="color:#ffffff" class="icon-lock-1"></i> Log out</a> 
                        </li>
                    </ul>
                </nav>
            </div>
        </aside>


        <!-- =Sidebar -->

        <section id="content-container" class="dark">

            <!-- Header -->

            <header id="header">
                <div id="menu-trigger" class="header-button left icon-menu"></div>
                <h1><a  href="index.html">FINDME</a></h1> 
            </header>

            <!-- =Header -->
            <div id="content">
                <table style=" border:none;margin-top:-5px;background-color: #3cabda;height:49px;width:100%">
                    <tr>
                        <th style="text-align: center"><a class='clickable-row' data-href='locate.html' style="color:#ffffff">Friends</a>
                        </th>
                        <th style="text-align: center"><a class='clickable-row' data-href='maps.html' style="color:#ffffff">Maps</a>
                        </th>
                    </tr>
                </table>
                <div class="hero" id="map-container-api" style="position:absolute ;z-index:0 ;margin-top:-5px">
                </div>
                <button id="direction" style=" display:none ;border-radius:50%; float:right; height: 50px;width: 50px;position:relative;z-index:5;background-image: url('images/road.PNG');background-repeat: no-repeat"></button>
            </div>
    </div>
    </section>
    <!-- =Main Content -->
    </div>
    <!-- =Container -->
    <script>
        !window.jQuery && document.write('<script src="js/vendor/jquery.js"><\/script>')
    </script>
    <script type="text/javascript">
        jQuery(document).ready(function($) {
                $(".clickable-row").click(function() {
                    window.location = $(this).data("href");
                });
            });
    </script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyABVLoGDUE6zaBkqoEUTlA2CnfFKtvRw7c&amp;sensor=false"></script>

    <script type="text/javascript">
        if( document.getElementById('map-container-api') != null){
        google.maps.visualRefresh = true;
        var map;
        var mapContainer = document.getElementById('map-container-api');
        function initialize() {
            var positions=[];
    
           $.post(
                    'http://findme2017.000webhostapp.com/findme/getFriends.php',
                    {
                        circle_id : 1                
                    },
    
                    function(data){  
                    var par = $.parseJSON(data);            
                        for (var i=0;i<par.users.length;i++) {
                            if(localStorage.getItem("user_id")!=par.users[i].id){
                                 if (!positions[i]) {                 
                                  positions[i] = [];               
                                   }   
                                var str = par.users[i].position;
                                var n = str.indexOf(",");
                                positions[i][0] = str.substring(0, n);
                                positions[i][1] = str.substring(n+1);
                                positions[i][2] = par.users[i].name;
                            }
                        }
                    //alert("total "+positions[0][0]+","+positions[0][1]); 
                    }
                 );
      function success(position) {
        var latitude  = position.coords.latitude;
        var longitude = position.coords.longitude; 
        var destlat;
        var destlng;
        var directionsDisplay;
        var markers=[];
        var directionsService = new google.maps.DirectionsService();
        var optionsCarte = {
              zoom: 10,
              center: new google.maps.LatLng(36.881854, 10.175030),
              mapTypeId : google.maps.MapTypeId.ROADMAP,
                streetViewControl : false
            }   
            var map = new google.maps.Map(mapContainer, optionsCarte);
            directionsDisplay = new google.maps.DirectionsRenderer({
                      map: map
                    });
            var marker1 = new google.maps.Marker({
                    map: map,
                    position: new google.maps.LatLng(36.881854, 10.175030),
                    icon:'http://maps.google.com/mapfiles/ms/icons/green-dot.png',
                    title: 'My Position'
                  }); 
            google.maps.event.addListener(map, 'click', function() {
        infowindow.close();
        document.getElementById('direction').style.display="none";
      });
            
            for(var i = 1 ; i < positions.length; i ++)
            {
                var marker = new google.maps.Marker({
                  id:positions[i][0],
                  map: map,
                  position: new google.maps.LatLng(positions[i][0],positions[i][1]),
                  name:positions[i][2]
                });  
                markers[i]=marker;
                var infowindow = new google.maps.InfoWindow({
                    maxWidth: 100,
                    maxHeight: 50
                });
                
    
       
                  
            google.maps.event.addListener(marker, 'click', (function(marker, i) {
              return function() {
                document.getElementById('direction').style.display="none";
                destlat=positions[i][0];
                destlng=positions[i][1];            
                var geocoder = new google.maps.Geocoder;
                var input = new google.maps.LatLng(positions[i][0],positions[i][1]);
                geocoder.geocode({'location': input}, function(results, status) {
                if (status === google.maps.GeocoderStatus.OK) {
                    if (results[1]) {
                        infowindow.setContent(positions[i][2]+'</br>'+
                        results[1].formatted_address);               
                    }else {
                     window.alert('No results found');
                    }
                }else {
                 window.alert('Geocoder failed due to: ' + status);
                }
                });
                infowindow.open(map, marker);
              }
            })(marker, i));

            $(document).ready(function(){
                    $("#direction").click(function(){
                        document.getElementById('direction').style.display="none";
                        marker1.setMap(null);
                        for(var i = 0 ; i < markers.length; i ++)
                        {
                        var mark = markers[i];
                        mark.setMap(null);
                        }
                                      
                    // Set destination, origin and travel mode.
                    var request = {
                      destination:  new google.maps.LatLng(destlat,destlng),
                      origin: new google.maps.LatLng(latitude, longitude),
                      travelMode: 'WALKING'
                    };
    
                    // Pass the directions request to the directions service.
                    var directionsService = new google.maps.DirectionsService();
                    directionsService.route(request, function(response, status) {
                      if (status == 'OK') {
                        // Display the route on the map.
                        directionsDisplay.setDirections(response);
                      }
                    });
                    });
            });
        }
    }
    function error(err) {
      alert("ERROR(" + err.code + "): " + err.message);   
    }
    navigator.geolocation.getCurrentPosition(success, error,{maximumAge: 180000,enableHighAccuracy: true});
          
        }
    
        google.maps.event.addDomListener(window, 'load', initialize);
    
    }
    </script>


    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>


    <!-- Custom Scripts -->

    <script src='js/plugins/klass.js'></script>
    <script src='js/plugins/photoswipe.js'></script>
    <script src='js/plugins/hammer.js'></script>
    <script src='js/plugins/flexslider.js'></script>
    <script src='js/plugins/h5validate.js'></script>
    <script src='js/plugins/responsivetables.js'></script>
    <script src='js/plugins/prism.js'></script>
    <script src='js/script.js'></script>

    <!-- =Custom Scripts -->

</body>


</html>